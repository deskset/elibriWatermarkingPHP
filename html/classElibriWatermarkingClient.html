<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Moduł&nbsp;PHP&nbsp;dla&nbsp;API&nbsp;Watermarkingu&nbsp;elibri: Dokumentacja klasy ElibriWatermarkingClient</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="stylesheet.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->

<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Moduł&nbsp;PHP&nbsp;dla&nbsp;API&nbsp;Watermarkingu&nbsp;elibri
   
   </div>
   <div id="projectbrief">Biblioteka&nbsp;abstrahująca&nbsp;dostęp&nbsp;do&nbsp;API&nbsp;eLibri</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Wygenerowano przez Doxygen 1.7.4 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Szukaj');
--></script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Strona&#160;główna</span></a></li>
      <li><a href="modules.html"><span>Moduły</span></a></li>
      <li class="current"><a href="annotated.html"><span>Klasy</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Szukaj" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Metody publiczne</a>  </div>
  <div class="headertitle">
<div class="title">Dokumentacja klasy ElibriWatermarkingClient</div>  </div>
</div>
<div class="contents">
<!-- doxytag: class="ElibriWatermarkingClient" -->
<p>ElibriAPI abstrahuje wykorzystanie API udostępniane przez eLibri.  
 <a href="classElibriWatermarkingClient.html#details">Więcej...</a></p>

<p><a href="classElibriWatermarkingClient-members.html">Lista wszystkich składowych.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Metody publiczne</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classElibriWatermarkingClient.html#aa567fda2c6f1fa8ac552d3fef5e25175">__construct</a> ($token, $secret, $subdomains=NULL)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Kontruktor obiektu API.  <a href="#aa567fda2c6f1fa8ac552d3fef5e25175"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classElibriWatermarkingClient.html#a693358ab8be00b75659ac71e8ff5b2ad">watermark</a> ($ident, $formats, $visible_watermark, $title_postfix, $customer_ip=NULL, $client_symbol=NULL)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Zlecaj watermarkowanie. Żeby skrócić maksymalnie oczekiwanie klienta na plik, podzieliliśmy cały proces watermarkingu na dwa etapy. Proponujemy, żeby zlecać watermarking tak wcześnie, jak to tylko możliwe (na przykład wtedy, gdy klient opuści koszyk, i poda swoje dane) eLibri rozpoczyna wtedy watermarkowanie książki, ale nie udostępnia jeszcze pliku sklepowi, ani nie rejestruje transakcji. Dopiero po dokonaniu płatności przez klienta należy wywołać metodę deliver, która to dostarczy plik do sklepu. Po umieszczeniu pliku na S3 nasz serwer łączy się z przekazanym przez Państwa URL-em (metoda POST), przekazując w parametrze trans_id identyfikator transakcji, która została ukończona.  <a href="#a693358ab8be00b75659ac71e8ff5b2ad"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classElibriWatermarkingClient.html#a71b2829ff44480bf0bcb368832cd903c">deliver</a> ($trans_id)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Dostarcz plik oraz zajestruj transakcję Ta metoda powinna zostać wywołana po watermark. Sklep powinien ją wywołać po zarejestrowaniu płatności przez klienta. Zwatermarkowany plik (pliki) zostaną przekopiowane do bucketu na amazon S3, który jest przypisany do sklepu. Sklep jest zobowiązany do wykasowania pliku po jego ściągnięciu.  <a href="#a71b2829ff44480bf0bcb368832cd903c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classElibriWatermarkingClient.html#ad6e2307695a64ddfe3923ec6ed45d675">retry</a> ($trans_id)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Zleca ponowne watermarkowanie wcześniej zakupionego pliku Sklep nie jest zobowiązany do przechowywania zwatermarkowanego pliku dłużej, niż 7 dni. Po tym czasie może wykasować plik, a jeśli klient będzie chciał ponownie pobrać plik, to można zlecić jego watermarkowanie poprzez retry. Każde wywołanie retry zwraca nowy identyfikator transakcji - należy go zapisać w swojej lokalnej bazie danych. Nie ma limitu wywołań retry, nie mogą one jednak występować częściej, niż co 7 dni. Przy kolejnym wywołaniu retry należy podać $trans_id pochodzący z poprzedniego wywołania retry. Operacje retry są bezpłatne, i nie są raportowane jako nowa sprzedaż. Zwracany jest nowy identyfikator transakcji, który trzeba zapisać w systemie (np. w miejsce poprzedniego identyfikatora). Po wywołaniu retry niezbędne jest wywołanie metody deliver z nowootrzymanym identyfikatorem transakcji.  <a href="#ad6e2307695a64ddfe3923ec6ed45d675"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af9a6022fe6ac97609d6726248da806bb"></a><!-- doxytag: member="ElibriWatermarkingClient::available_files" ref="af9a6022fe6ac97609d6726248da806bb" args="()" -->
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classElibriWatermarkingClient.html#af9a6022fe6ac97609d6726248da806bb">available_files</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Pobierz listę dostępnych plików Za pomocą tej metody możesz pobrać listę książek, które są lub będą w najbliższym czasie dostępne w systemie eLibri. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a30683d237fbf5ec5381871c83682d121"></a><!-- doxytag: member="ElibriWatermarkingClient::soon_available_files" ref="a30683d237fbf5ec5381871c83682d121" args="()" -->
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classElibriWatermarkingClient.html#a30683d237fbf5ec5381871c83682d121">soon_available_files</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Ponierz listę plików, których premiera się zbliża Za pomocą tej metody możesz pobrać listę ksiażek, które nie są w tej chwili dostępne, ale ich premiera jest wkrótce. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="afafdf8a68bee4c40c4273abd68627d8b"></a><!-- doxytag: member="ElibriWatermarkingClient::soon_unavailable_files" ref="afafdf8a68bee4c40c4273abd68627d8b" args="()" -->
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classElibriWatermarkingClient.html#afafdf8a68bee4c40c4273abd68627d8b">soon_unavailable_files</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Ponierz listę plików, które wkrótce przestaną być dostępne Za pomocą tej metody możesz pobrać listę ksiażek, które wkrótce przestaną być dostępne. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classElibriWatermarkingClient.html#a74ee467f384e4254b7f6ebcd7e0b17d7">check_suppliers</a> ($ident)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Pobierz listę możliwych dostawców pliku. Pobiera listę możliwych dostawców pliku. Ma to znaczenie tylko w przypadku książek, które mogą zostać zafakturowane zarówno na konto dystrybutora, jak i wydawcy.  <a href="#a74ee467f384e4254b7f6ebcd7e0b17d7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classElibriWatermarkingClient.html#aa2ba99c2b2fc47181373678ac31a4077">get_supplier</a> ($id)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Pobierz nazwę dostawcy Pobiera nazwę dostawcy o określonym id (zwracanym przez check_suppliers)  <a href="#aa2ba99c2b2fc47181373678ac31a4077"></a><br/></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Opis szczegółowy</h2>
<div class="textblock"><p>ElibriAPI abstrahuje wykorzystanie API udostępniane przez eLibri. </p>
</div><hr/><h2>Dokumentacja konstruktora i destruktora</h2>
<a class="anchor" id="aa567fda2c6f1fa8ac552d3fef5e25175"></a><!-- doxytag: member="ElibriWatermarkingClient::__construct" ref="aa567fda2c6f1fa8ac552d3fef5e25175" args="($token, $secret, $subdomains=NULL)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ElibriWatermarkingClient::__construct </td>
          <td>(</td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>token</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>secret</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>subdomains</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Kontruktor obiektu API. </p>
<dl><dt><b>Parametry:</b></dt><dd>
  <table class="params">
    <tr><td class="paramtype">String</td><td class="paramname">$token</td><td>- publiczny token eLibri Watermarking API </td></tr>
    <tr><td class="paramtype">String</td><td class="paramname">$secret</td><td>- prywatny token eLibri Watermarking API </td></tr>
    <tr><td class="paramtype">Array</td><td class="paramname">$subdomains</td><td>- lista subdomen, opcjonalnie. Przydatne, gdy używana wersja PHP nie zawiera metody dns_get_record </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/><h2>Dokumentacja funkcji składowych</h2>
<a class="anchor" id="a74ee467f384e4254b7f6ebcd7e0b17d7"></a><!-- doxytag: member="ElibriWatermarkingClient::check_suppliers" ref="a74ee467f384e4254b7f6ebcd7e0b17d7" args="($ident)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ElibriWatermarkingClient::check_suppliers </td>
          <td>(</td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>ident</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Pobierz listę możliwych dostawców pliku. Pobiera listę możliwych dostawców pliku. Ma to znaczenie tylko w przypadku książek, które mogą zostać zafakturowane zarówno na konto dystrybutora, jak i wydawcy. </p>
<dl><dt><b>Parametry:</b></dt><dd>
  <table class="params">
    <tr><td class="paramtype">String</td><td class="paramname">$ident</td><td>- identyfikator produktu (record_reference albo isbn bez kresek) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a71b2829ff44480bf0bcb368832cd903c"></a><!-- doxytag: member="ElibriWatermarkingClient::deliver" ref="a71b2829ff44480bf0bcb368832cd903c" args="($trans_id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ElibriWatermarkingClient::deliver </td>
          <td>(</td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>trans_id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Dostarcz plik oraz zajestruj transakcję Ta metoda powinna zostać wywołana po watermark. Sklep powinien ją wywołać po zarejestrowaniu płatności przez klienta. Zwatermarkowany plik (pliki) zostaną przekopiowane do bucketu na amazon S3, który jest przypisany do sklepu. Sklep jest zobowiązany do wykasowania pliku po jego ściągnięciu. </p>
<dl><dt><b>Parametry:</b></dt><dd>
  <table class="params">
    <tr><td class="paramtype">String</td><td class="paramname">$trans_id</td><td>- alfanumeryczny identyfikator transakcji zwrócony przez metodę watermark </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="aa2ba99c2b2fc47181373678ac31a4077"></a><!-- doxytag: member="ElibriWatermarkingClient::get_supplier" ref="aa2ba99c2b2fc47181373678ac31a4077" args="($id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ElibriWatermarkingClient::get_supplier </td>
          <td>(</td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Pobierz nazwę dostawcy Pobiera nazwę dostawcy o określonym id (zwracanym przez check_suppliers) </p>
<dl><dt><b>Parametry:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">$id</td><td>- numeryczny identyfikator dostawcy </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ad6e2307695a64ddfe3923ec6ed45d675"></a><!-- doxytag: member="ElibriWatermarkingClient::retry" ref="ad6e2307695a64ddfe3923ec6ed45d675" args="($trans_id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ElibriWatermarkingClient::retry </td>
          <td>(</td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>trans_id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Zleca ponowne watermarkowanie wcześniej zakupionego pliku Sklep nie jest zobowiązany do przechowywania zwatermarkowanego pliku dłużej, niż 7 dni. Po tym czasie może wykasować plik, a jeśli klient będzie chciał ponownie pobrać plik, to można zlecić jego watermarkowanie poprzez retry. Każde wywołanie retry zwraca nowy identyfikator transakcji - należy go zapisać w swojej lokalnej bazie danych. Nie ma limitu wywołań retry, nie mogą one jednak występować częściej, niż co 7 dni. Przy kolejnym wywołaniu retry należy podać $trans_id pochodzący z poprzedniego wywołania retry. Operacje retry są bezpłatne, i nie są raportowane jako nowa sprzedaż. Zwracany jest nowy identyfikator transakcji, który trzeba zapisać w systemie (np. w miejsce poprzedniego identyfikatora). Po wywołaniu retry niezbędne jest wywołanie metody deliver z nowootrzymanym identyfikatorem transakcji. </p>
<dl><dt><b>Parametry:</b></dt><dd>
  <table class="params">
    <tr><td class="paramtype">String</td><td class="paramname">$trans_id</td><td>- alfanumeryczny identyfikator transakcji zwrócony przez metodę watermark lub retry </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Zwraca:</b></dt><dd>$transid - alfanumeryczny identyfikator nowej transakcji </dd></dl>

</div>
</div>
<a class="anchor" id="a693358ab8be00b75659ac71e8ff5b2ad"></a><!-- doxytag: member="ElibriWatermarkingClient::watermark" ref="a693358ab8be00b75659ac71e8ff5b2ad" args="($ident, $formats, $visible_watermark, $title_postfix, $customer_ip=NULL, $client_symbol=NULL)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ElibriWatermarkingClient::watermark </td>
          <td>(</td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>ident</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>formats</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>visible_watermark</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>title_postfix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>customer_ip</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>client_symbol</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Zlecaj watermarkowanie. Żeby skrócić maksymalnie oczekiwanie klienta na plik, podzieliliśmy cały proces watermarkingu na dwa etapy. Proponujemy, żeby zlecać watermarking tak wcześnie, jak to tylko możliwe (na przykład wtedy, gdy klient opuści koszyk, i poda swoje dane) eLibri rozpoczyna wtedy watermarkowanie książki, ale nie udostępnia jeszcze pliku sklepowi, ani nie rejestruje transakcji. Dopiero po dokonaniu płatności przez klienta należy wywołać metodę deliver, która to dostarczy plik do sklepu. Po umieszczeniu pliku na S3 nasz serwer łączy się z przekazanym przez Państwa URL-em (metoda POST), przekazując w parametrze trans_id identyfikator transakcji, która została ukończona. </p>
<dl><dt><b>Parametry:</b></dt><dd>
  <table class="params">
    <tr><td class="paramtype">String</td><td class="paramname">$ident</td><td>- ISBN13 (bez myślików), lub record_reference </td></tr>
    <tr><td class="paramtype">String</td><td class="paramname">$formats</td><td>- 'mobi', 'epub', lub 'mobi,epub' </td></tr>
    <tr><td class="paramtype">String</td><td class="paramname">$visible_watermark</td><td>- stopka doklejana na końcu każdego rozdziału </td></tr>
    <tr><td class="paramtype">String</td><td class="paramname">$title_postfix</td><td>- tekst doklejany do tytułu książki </td></tr>
    <tr><td class="paramtype">String</td><td class="paramname">$customer_ip</td><td>- numer IP klienta, używany w celach wyłącznie statystycznych </td></tr>
    <tr><td class="paramtype">String</td><td class="paramname">$client_symbol</td><td>- opcjonalny identyfikator promocji </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Zwraca:</b></dt><dd>$transid - alfanumeryczny identyfikator transakcji </dd></dl>

</div>
</div>
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Klasy</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Funkcje</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Wygenerowano dla Moduł&nbsp;PHP&nbsp;dla&nbsp;API&nbsp;Watermarkingu&nbsp;elibri programem&#160;<a href="http://www.doxygen.org/index.html">1.7.4</a></small></address>

</body>
</html>
